---
subcategory: "Cloud Storage"
description: |-
  Creates a new notification configuration on a specified bucket.
---


<!-- Please do not edit this file, it is generated. -->
# google\_storage\_notification

Creates a new notification configuration on a specified bucket, establishing a flow of event notifications from GCS to a Cloud Pub/Sub topic.
 For more information see
[the official documentation](https://cloud.google.com/storage/docs/pubsub-notifications)
and
[API](https://cloud.google.com/storage/docs/json_api/v1/notifications).

In order to enable notifications, a special Google Cloud Storage service account unique to the project
must exist and have the IAM permission "projects.topics.publish" for a Cloud Pub/Sub topic in the project.
This service account is not created automatically when a project is created.
To ensure the service account exists and obtain its email address for use in granting the correct IAM permission, use the
[`google_storage_project_service_account`](/docs/providers/google/d/storage_project_service_account.html)
datasource's `email_address` value, and see below for an example of enabling notifications by granting the correct IAM permission.
See [the notifications documentation](https://cloud.google.com/storage/docs/gsutil/commands/notification) for more details.

>**NOTE**: This resource can affect your storage IAM policy. If you are using this in the same config as your storage IAM policy resources, consider
making this resource dependent on those IAM resources via `depends_on`. This will safeguard against errors due to IAM race conditions.

## Example Usage

```python
import constructs as constructs
import cdktf as cdktf
# Provider bindings are generated by running cdktf get.
# See https://cdk.tf/provider-generation for more details.
import ...gen.providers.google as google
class MyConvertedCode(cdktf.TerraformStack):
    def __init__(self, scope, name):
        super().__init__(scope, name)
        google_pubsub_topic_topic = google.pubsub_topic.PubsubTopic(self, "topic",
            name="default_topic"
        )
        google_storage_bucket_bucket = google.storage_bucket.StorageBucket(self, "bucket",
            location="US",
            name="default_bucket"
        )
        data_google_storage_project_service_account_gcs_account =
        google.data_google_storage_project_service_account.DataGoogleStorageProjectServiceAccount(self, "gcs_account")
        google_pubsub_topic_iam_binding_binding =
        google.pubsub_topic_iam_binding.PubsubTopicIamBinding(self, "binding",
            members=["serviceAccount:${" + data_google_storage_project_service_account_gcs_account.email_address + "}"
            ],
            role="roles/pubsub.publisher",
            topic=cdktf.Token.as_string(google_pubsub_topic_topic.id)
        )
        google.storage_notification.StorageNotification(self, "notification",
            bucket=cdktf.Token.as_string(google_storage_bucket_bucket.name),
            custom_attributes={
                "new-attribute": "new-attribute-value"
            },
            depends_on=[google_pubsub_topic_iam_binding_binding],
            event_types=["OBJECT_FINALIZE", "OBJECT_METADATA_UPDATE"],
            payload_format="JSON_API_V1",
            topic=cdktf.Token.as_string(google_pubsub_topic_topic.id)
        )
```

## Argument Reference

The following arguments are supported:

* `bucket` - (Required) The name of the bucket.

* `payload_format` - (Required) The desired content of the Payload. One of `"JSON_API_V1"` or `"NONE"`.

* `topic` - (Required) The Cloud PubSub topic to which this subscription publishes. Expects either the
    topic name, assumed to belong to the default GCP provider project, or the project-level name,
    i.e. `projects/my-gcp-project/topics/my-topic` or `my-topic`. If the project is not set in the provider,
    you will need to use the project-level name.

- - -

* `custom_attributes` - (Optional)  A set of key/value attribute pairs to attach to each Cloud PubSub message published for this notification subscription

* `event_types` - (Optional) List of event type filters for this notification config. If not specified, Cloud Storage will send notifications for all event types. The valid types are: `"OBJECT_FINALIZE"`, `"OBJECT_METADATA_UPDATE"`, `"OBJECT_DELETE"`, `"OBJECT_ARCHIVE"`

* `object_name_prefix` - (Optional) Specifies a prefix path filter for this notification config. Cloud Storage will only send notifications for objects in this bucket whose names begin with the specified prefix.

## Attributes Reference

In addition to the arguments listed above, the following computed attributes are
exported:

* `notification_id` - The ID of the created notification.

* `self_link` - The URI of the created resource.

## Import

Storage notifications can be imported using the notification `id` in the format `<bucket_name>/notificationConfigs/<id>` e.g.

```
$ terraform import google_storage_notification.notification default_bucket/notificationConfigs/102
```

<!-- cache-key: cdktf-0.17.0-pre.15 input-434cdbbe5c75039156cd41db5c6f57d142210cd6fff24f311c0dc201f837766d -->