---
subcategory: "Cloud Platform"
description: |-
  Produces access_token for impersonated service accounts
---


<!-- Please do not edit this file, it is generated. -->
# google\_service\_account\_access\_token

This data source provides a google `oauth2` `accessToken` for a different service account than the one initially running the script.

For more information see
[the official documentation](https://cloud.google.com/iam/docs/creating-short-lived-service-account-credentials) as well as [iamcredentials.generateAccessToken()](https://cloud.google.com/iam/credentials/reference/rest/v1/projects.serviceAccounts/generateAccessToken)

## Example Usage

To allow `serviceA` to impersonate `serviceB`, grant the [Service Account Token Creator](https://cloud.google.com/iam/docs/service-accounts#the_service_account_token_creator_role) on B to A. 

In the IAM policy below, `serviceA` is given the Token Creator role impersonate `serviceB`

```hcl
resource "google_service_account_iam_binding" "token-creator-iam" {
	service_account_id = "projects/-/serviceAccounts/service_B@projectB.iam.gserviceaccount.com"
	role               = "roles/iam.serviceAccountTokenCreator"
	members = [
		"serviceAccount:service_A@projectA.iam.gserviceaccount.com",
	]
}
```

Once the IAM permissions are set, you can apply the new token to a provider bootstrapped with it.  Any resources that references the aliased provider will run as the new identity.

In the example below, `googleProject` will run as `serviceB`.

```hcl
provider "google" {
}

data "google_client_config" "default" {
  provider = google
}

data "google_service_account_access_token" "default" {
  provider               = google
  target_service_account = "service_B@projectB.iam.gserviceaccount.com"
  scopes                 = ["userinfo-email", "cloud-platform"]
  lifetime               = "300s"
}

provider "google" {
  alias        = "impersonated"
  access_token = data.google_service_account_access_token.default.access_token
}

data "google_client_openid_userinfo" "me" {
  provider = google.impersonated
}

output "target-email" {
  value = data.google_client_openid_userinfo.me.email
}
```

> *Note*: the generated token is non-refreshable and can have a maximum `lifetime` of `3600` seconds.

## Argument Reference

The following arguments are supported:

* `targetServiceAccount` (Required) - The service account _to_ impersonate (e.g. `serviceB@yourProjectIdIamGserviceaccountCom`)
* `scopes` (Required) - The scopes the new credential should have (e.g. `["cloudPlatform"]`)
* `delegates` (Optional) - Delegate chain of approvals needed to perform full impersonation. Specify the fully qualified service account name.  (e.g. `["projects/-/serviceAccounts/delegateSvcAccount@projectIdIamGserviceaccountCom"]`)
* `lifetime` (Optional) Lifetime of the impersonated token (defaults to its max: `3600S`).

## Attributes Reference

The following attribute is exported:

* `accessToken` - The `accessToken` representing the new generated identity.

<!-- cache-key: cdktf-0.17.0-pre.15 input-072822a97c485c23adbe9904c9af65c4e6bc4356c604a631f120f52f4a3337fc -->